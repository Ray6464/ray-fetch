#!/usr/bin/env node
const fetch=require("node-fetch"),fs=Object.assign({},require("ray-fs")),flags=require("ray-flags"),{sucide}=require("sucide");let fileName="file1.mp4",towerIPAndPort="localhost:3030",protocol="http:";void 0!==flags.file&&(fileName=flags.file),void 0!==flags.ip&&(towerIPAndPort=flags.ip),void 0!==flags.protocol&&(protocol=flags.protocol);const requestObject={breadCrumbs:[protocol,towerIPAndPort,fileName],requestedResource:fileName},responseObject={file:fileName};if(flags.req){let e="http://localhost:3001/request/";void 0!==flags.url&&(e=flags.url);let o=e;flags.tower&&(o+=JSON.stringify(requestObject)),console.log(e),fetch(o).then(e=>e.json()).then(e=>{console.log(e)}).catch(e=>{console.log(e)})}else if(flags.res){let e="http://localhost:3001/fetch/";void 0!==flags.url&&(e=flags.url);let o=e;flags.tower&&(o+=JSON.stringify(responseObject)),fetch(o).then(e=>404!=e.status?e.body:void(404==e.status&&sucide("Requested Resource not found!"))).then(e=>{fs.stream(e,fileName)}).catch(e=>{console.log(e)})}